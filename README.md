# 내일배움캠프 심화주차 개인과제
게임명 : Murder Soccer <br/>
엔진 : Unity3D 2022 3.2f1 <br/>
플랫폼 : PC <br/>
장르 : 3D, 멀티플레이, 아케이드 <br/>
제작기간 : 2023.12.24 ~ 2023.12.29 <br/><br/>
사용 에셋
* Photon Pun 2 Free
* YughuesFreeMetalMaterials
* Mixamo
___
# 게임 설명
공을 차서 다른 플레이어를 맞추면 되는 간단한 게임입니다. 

## 조작법
### 캐릭터 이동
키보드 WASD로 상하좌우 이동

### 공차기 준비
마우스 L버튼 누르기 <br/>
근처의 공을 발밑으로 끌어오고 공차기 강도를 충전을 시작합니다.

### 공차기 강도 조절
마우스 L버튼 Hold <br/>
누르고 있는 동안 발차기의 강도가 강해집니다. <br/>
최대 3초 충전할 수 있습니다.

### 공차기 방향 조절
마우스 커서 위치를 향해 공을 찹니다

### 공 차기
마우스 L버튼을 떼거나 최대 충전 시간이 되면 공을 찹니다

## 규칙
게임에는 여러 명의 플레이어가 접속할 수 있지만, 공은 단 하나입니다. <br/>
스폰된 플레이어는 3초동안 무적 상태입니다. <br/>
공은 벽에 닿으면 반사되어 튕겨져나갑니다. <br/>
플레이어는 공에 닿으면 죽습니다. 죽게 되면 리스폰할 수 있습니다. <br/>
___
# 기능 설명
## 멀티플레이
Photon Pun 2 Free를 이용해 멀티플레이 환경을 구현했습니다. <br/>

### 서버, 방 접속
게임을 시작하면 `PhotonConnector` 클래스를 이용해 마스터 서버에 접속 후, 방에 들어옵니다. <br/>
1개의 방만 사용하도록 설정돼 있고, 생성된 방이 없다면 생성 후 들어가게 됩니다. <br/>

### MasterClient - LocalPlayer 데이터 동기화
공의 물리연산은 MasterClient에서 처리할 수 있도록 하고, LocalPlayer는 최소한의 연산만 할 수 있도록 했습니다. <br/>
객체의 실시간 정보는 PhotonView 컴포넌트와 IPunObservable 인터페이스 구현을 이용해 동기화했습니다. <br/>
특정 조건에서 공의 정보가 바뀌는 경우에는 메서드를 RPC로 호출해 동기화했습니다.

### 호스트 마이그레이션
공은 게임에 단 하나만 존재하므로 필연적으로 MasterClient 소유입니다. <br/>
그렇기 때문에, MasterClient가 접속을 종료하면 공도 함께 사라집니다. <br/>
때문에, 모든 플레이어가 `BallStateStruct`라는 구조체를 이용하여 공의 실시간 상태를 감시하다가 MasterClient가 접속을 끊고 공이 사라지면 새로운 MasterClient가 기존의 공과 같은 공을 생성하도록 했습니다.

## 체계적인 게임 초기화
`GameManager`에서 게임을 초기화하는 과정을 체계적이고, 실행 순서를 보장할 수 있도록 설계했습니다.
1. `ResourceManager`에게 리소스 로드를 요청하여 씬에 필요한 리소스들을 Addressable을 이용해 로드합니다.
2. 리소스 로드를 완료하면, `PhotonConnector`에게 포톤 서버, 방 접속을 요청합니다.
3. 방 접속을 완료하면, 객체를 생성하고 게임을 시작합니다.
